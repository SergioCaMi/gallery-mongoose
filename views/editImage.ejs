<!-- views/editImage.ejs -->

<%- include("template/cabecera", { title: "Editar Imagen" }) %>

<div class="container edit-container">
  <% if (dataImage && dataImage.length > 0) { %>
    <% const image = dataImage[0]; %>

    <!-- Incluimos el card con la imagen -->
    <%- include("template/imageCard.ejs", { dataImage: dataImage }) %>

    <!-- Formulario de edición -->
    <form class="formulario container" id="imageForm" action="/edit-image" method="POST">
      <input type="hidden" name="id" value="<%= image._id %>">

      <div class="form-group">
        <label for="title">Título:</label>
        <input type="text" id="title" name="title" maxlength="30" pattern="^[a-zA-Z0-9 _]+$" value="<%= image.title %>" required>
      </div>

      <div class="form-group">
        <label for="date">Fecha:</label>
        <input type="date" id="date" name="date" value="<%= image.date %>" required>
      </div>

      <div class="form-group">
        <label for="description">Descripción:</label>
        <textarea id="description" name="description" maxlength="4000" rows="6"><%= image.description %></textarea>
      </div>

      <button type="submit" class="submit-btn">📤 Guardar cambios</button>
    </form>

  <% } else { %>
    <div class="no-image">
      <h2>Imagen no encontrada.</h2>
      <a href="/" class="btn btn-back">← Volver al inicio</a>
    </div>
  <% } %>
</div>
      <div class="details-bottom">
        <a href="/" class="btn btn-back">← Volver al inicio</a>
      </div>

<%- include("template/footer") %>

<script>
  const imageData = <%= JSON.stringify(dataImage[0] || null) %>;
</script>